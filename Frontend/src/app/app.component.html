<header class="header-nav">
  <div class="container nav-container">
    
    <a [routerLink]="esAdminPanel ? '/admin' : '/'" class="nav-brand-logo">
      <img src="https://i.ibb.co/vvQB6mbN/logo-feel.png" alt="FEEL" class="logo-animado">
      <span *ngIf="esAdminPanel" class="badge-admin-header">ADMIN</span>
    </a>

    <nav>
      
      <ng-container *ngIf="!esAdminPanel">
        <a routerLink="/tienda" routerLinkActive="active">Tienda</a>
        
        @if (authService.isLoggedIn()) {
          <a routerLink="/historial" routerLinkActive="active">Mis Pedidos</a>
        }

        <a routerLink="/carrito" routerLinkActive="active" class="nav-carrito">
          <span class="carrito-icon">üõí</span>
        </a>
      </ng-container>

      <div class="profile-section">
        @if (authService.isLoggedIn()) {
          <button class="profile-trigger" (click)="toggleMenu()">
            @if (authService.currentUserFotoUrl()) {
              <img [src]="authService.currentUserFotoUrl()" alt="Foto de perfil" class="profile-trigger-img">
            } @else {
              <span>{{ getUserInitials() }}</span>
            }
          </button>

          <div class="profile-menu" [class.show]="menuVisible()">
             <div class="profile-menu-header">
                @if (authService.currentUserFotoUrl()) {
                  <img [src]="authService.currentUserFotoUrl()" alt="Foto de perfil" class="profile-menu-img">
                } @else {
                  <span class="profile-menu-avatar">{{ getUserInitials() }}</span>
                }
                <strong>{{ authService.currentUserName() || 'Usuario' }}</strong>
                <small>{{ authService.currentUserEmail() || 'email@ejemplo.com' }}</small>
             </div>
              <ul>
                <ng-container *ngIf="!esAdminPanel">
                  <li><a routerLink="/perfil" (click)="menuVisible.set(false)">üë§ Mi perfil</a></li>
                  <li><a routerLink="/historial" (click)="menuVisible.set(false)">üõçÔ∏è Mis pedidos</a></li>
                  <li><a routerLink="/favoritos" (click)="menuVisible.set(false)">‚ù§Ô∏è Favoritos</a></li>
                  <li><hr></li>
                </ng-container>

                <li><a (click)="logout()" style="cursor: pointer;">‚Ü™Ô∏è Cerrar sesi√≥n</a></li>
              </ul>
          </div>
        } @else {
          <a routerLink="/auth" routerLinkActive="active" class="nav-cta">Login</a>
        }
      </div>

    </nav>
  </div>
</header>

<main>
  <div class="container main-content">
    <router-outlet></router-outlet>
  </div>
</main>

<footer class="footer">
  <div class="container">
    <p>&copy; 2025 FEEL STORE. Todos los derechos reservados.</p>
  </div>
</footer>